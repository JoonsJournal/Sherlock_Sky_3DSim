<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸ§ª Test: Cleanroom Sidebar (Standalone)</title>
    
    <style>
        /* =============================================
           TEST FRAMEWORK STYLES
           ============================================= */
        .test-framework {
            position: fixed;
            top: 10px;
            right: 10px;
            width: 350px;
            background: #1a1a2e;
            border: 1px solid #16213e;
            border-radius: 12px;
            padding: 16px;
            font-family: 'Consolas', monospace;
            font-size: 12px;
            color: #e5e5e5;
            z-index: 9999;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .test-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid #16213e;
        }
        
        .test-title {
            font-size: 14px;
            font-weight: bold;
            color: #06B6D4;
        }
        
        .test-stats {
            display: flex;
            gap: 12px;
            font-size: 11px;
        }
        
        .stat-pass { color: #4CAF50; }
        .stat-fail { color: #F44336; }
        .stat-pending { color: #FFC107; }
        
        .test-group {
            margin-bottom: 16px;
        }
        
        .test-group-title {
            font-size: 12px;
            font-weight: bold;
            color: #9CA3AF;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .test-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 8px;
            margin: 4px 0;
            background: rgba(255,255,255,0.03);
            border-radius: 6px;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .test-item:hover {
            background: rgba(255,255,255,0.08);
        }
        
        .test-icon {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
        }
        
        .test-icon.pass { background: #4CAF50; }
        .test-icon.fail { background: #F44336; }
        .test-icon.pending { background: #FFC107; color: #000; }
        .test-icon.running { 
            background: #2196F3; 
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .test-name {
            flex: 1;
            color: #e5e5e5;
        }
        
        .test-time {
            color: #6B7280;
            font-size: 10px;
        }
        
        .test-actions {
            display: flex;
            gap: 8px;
            margin-top: 16px;
            padding-top: 12px;
            border-top: 1px solid #16213e;
        }
        
        .test-btn {
            flex: 1;
            padding: 10px 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-family: inherit;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.2s;
        }
        
        .test-btn-primary {
            background: linear-gradient(135deg, #06B6D4, #0891B2);
            color: white;
        }
        
        .test-btn-primary:hover {
            box-shadow: 0 0 20px rgba(6, 182, 212, 0.4);
        }
        
        .test-btn-secondary {
            background: rgba(255,255,255,0.1);
            color: #e5e5e5;
        }
        
        .test-btn-secondary:hover {
            background: rgba(255,255,255,0.15);
        }
        
        .test-log {
            margin-top: 16px;
            padding: 12px;
            background: rgba(0,0,0,0.3);
            border-radius: 8px;
            font-size: 11px;
            max-height: 150px;
            overflow-y: auto;
        }
        
        .log-entry {
            padding: 2px 0;
            color: #9CA3AF;
        }
        
        .log-entry.success { color: #4CAF50; }
        .log-entry.error { color: #F44336; }
        .log-entry.info { color: #06B6D4; }

        /* =============================================
           1. Theme Configuration (Cleanroom Palette)
           ============================================= */
        :root {
            /* Background Colors */
            --bg-sidebar: #0F172A;
            --bg-main: #FFFFFF;
            
            /* Icon Colors */
            --icon-normal: #E2E8F0;
            --icon-selected: #06B6D4;
            --icon-disabled: #334155;
            
            /* Status Text Colors */
            --text-normal: #CBD5E1;
            --text-warning: #FBBF24;
            --text-alarm: #F87171;

            /* Interaction Settings */
            --transition-speed: 0.25s;
        }

        /* Reset & Layout */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            display: flex; 
            height: 100vh; 
            overflow: hidden; 
            font-family: 'Segoe UI', sans-serif;
            background: #1e293b;
        }
        
        /* =============================================
           2. Sidebar (Left)
           ============================================= */
        .sidebar {
            width: 80px;
            background-color: var(--bg-sidebar);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 24px;
            z-index: 10;
            box-shadow: 4px 0 15px rgba(0,0,0,0.25);
            transition: width 0.3s ease;
        }

        /* Icon Button Container */
        .icon-btn {
            width: 50px;
            height: 50px;
            margin-bottom: 20px;
            background: transparent;
            border: none;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            transition: transform var(--transition-speed) cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        /* SVG Style Common */
        .icon-btn svg {
            width: 28px;
            height: 28px;
            fill: none;
            stroke: var(--icon-normal);
            stroke-width: 2px;
            stroke-linecap: round;
            stroke-linejoin: round;
            transition: all var(--transition-speed);
        }

        /* =============================================
           3. Interaction Logic (Hover & Selected)
           ============================================= */
        
        /* Hover Effect */
        .icon-btn:not(.selected):hover {
            transform: scale(1.15) translateY(-4px);
        }
        .icon-btn:not(.selected):hover svg {
            stroke: #FFFFFF;
            stroke-width: 3px;
            filter: drop-shadow(0 0 4px rgba(255, 255, 255, 0.4));
        }

        /* Selected Effect */
        .icon-btn.selected {
            transform: scale(1.15) translateY(-4px);
        }
        .icon-btn.selected svg {
            stroke: var(--icon-selected);
            stroke-width: 3px;
            filter: drop-shadow(0 0 8px var(--icon-selected));
        }

        /* Indicator Line for Selected Item */
        .icon-btn.selected::before {
            content: '';
            position: absolute;
            left: -15px;
            width: 4px;
            height: 30px;
            background-color: var(--icon-selected);
            border-radius: 0 4px 4px 0;
            box-shadow: 0 0 8px var(--icon-selected);
        }

        /* Disabled State */
        .icon-btn.disabled {
            cursor: not-allowed;
            opacity: 0.4;
        }
        .icon-btn.disabled svg {
            stroke: var(--icon-disabled);
        }
        .icon-btn.disabled:hover {
            transform: none;
        }

        /* =============================================
           4. Main Content Area
           ============================================= */
        .main-content {
            flex-grow: 1;
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            padding: 40px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #e5e5e5;
        }

        .main-content h1 {
            font-size: 32px;
            margin-bottom: 16px;
            background: linear-gradient(135deg, #06B6D4, #8B5CF6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .main-content p {
            color: #9CA3AF;
        }

        /* Current Mode Display */
        .current-mode {
            margin-top: 40px;
            padding: 20px 40px;
            background: rgba(6, 182, 212, 0.1);
            border: 1px solid rgba(6, 182, 212, 0.3);
            border-radius: 12px;
            text-align: center;
        }

        .mode-label {
            font-size: 12px;
            color: #9CA3AF;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }

        .mode-value {
            font-size: 24px;
            font-weight: bold;
            color: #06B6D4;
        }

        /* =============================================
           5. Status Bar (Bottom)
           ============================================= */
        .status-bar {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 36px;
            background-color: var(--bg-sidebar);
            border-top: 1px solid rgba(255,255,255,0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            box-sizing: border-box;
            font-family: 'Consolas', monospace;
            font-size: 13px;
            z-index: 20;
        }

        .status-group { display: flex; gap: 24px; }
        .status-item { display: flex; align-items: center; gap: 8px; }
        
        .status-normal { color: var(--text-normal); }
        .status-warning { color: var(--text-warning); font-weight: 600; }
        .status-alarm { 
            color: var(--text-alarm); 
            font-weight: 700; 
            animation: pulse-alarm 1.5s infinite; 
        }

        .dot { 
            width: 8px; 
            height: 8px; 
            border-radius: 50%; 
            background-color: currentColor; 
        }

        @keyframes pulse-alarm {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        /* Tooltip */
        .icon-btn::after {
            content: attr(data-tooltip);
            position: absolute;
            left: 70px;
            background: rgba(0,0,0,0.9);
            color: white;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s, transform 0.2s;
            transform: translateX(-10px);
        }

        .icon-btn:hover::after {
            opacity: 1;
            transform: translateX(0);
        }

        /* Divider */
        .sidebar-divider {
            width: 40px;
            height: 1px;
            background: rgba(255,255,255,0.1);
            margin: 10px 0;
        }

        /* Spacer */
        .sidebar-spacer {
            flex-grow: 1;
        }
    </style>
</head>
<body>

    <!-- =============================================
         SIDEBAR COMPONENT
         ============================================= -->
    <aside class="sidebar" id="sidebar">
        
        <!-- Connection Button -->
        <button class="icon-btn selected" id="btn-connection" data-mode="connection" data-tooltip="Connection Setup (Ctrl+K)">
            <svg viewBox="0 0 24 24">
                <path d="M4 6c0 1.66 3.58 3 8 3s8-1.34 8-3"/>
                <path d="M20 6v6c0 1.66-3.58 3-8 3s-8-1.34-8-3V6"/>
                <ellipse cx="12" cy="6" rx="8" ry="3"/>
                <path d="M19.5 15.5a2.5 2.5 0 0 0-3.8-2.3 2.5 2.5 0 0 0-1.2 3.8 2.5 2.5 0 0 0 3.5 1.2" stroke-dasharray="2 1" />
                <circle cx="19" cy="19" r="3" />
                <path d="M19 19m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" fill="currentColor" stroke="none"/>
            </svg>
        </button>

        <!-- Mapping Button -->
        <button class="icon-btn" id="btn-mapping" data-mode="mapping" data-tooltip="Data Mapping">
            <svg viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="3" />
                <line x1="12" y1="12" x2="5" y2="5" />
                <circle cx="5" cy="5" r="2" />
                <line x1="12" y1="12" x2="19" y2="5" />
                <circle cx="19" cy="5" r="2" />
                <line x1="12" y1="12" x2="5" y2="19" />
                <circle cx="5" cy="19" r="2" />
                <line x1="12" y1="12" x2="19" y2="19" />
                <circle cx="19" cy="19" r="2" />
            </svg>
        </button>

        <!-- Monitoring Button -->
        <button class="icon-btn" id="btn-monitoring" data-mode="monitoring" data-tooltip="System Monitoring (M)">
            <svg viewBox="0 0 24 24">
                <rect x="3" y="4" width="18" height="12" rx="2" />
                <polyline points="6 10 9 10 11 7 13 13 15 10 18 10" />
                <path d="M12 16v4" />
                <path d="M8 20h8" />
            </svg>
        </button>

        <div class="sidebar-divider"></div>

        <!-- Edit Button -->
        <button class="icon-btn" id="btn-edit" data-mode="edit" data-tooltip="Edit Mode (E)">
            <svg viewBox="0 0 24 24">
                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                <path d="M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z"/>
            </svg>
        </button>

        <!-- Layout Button -->
        <button class="icon-btn" id="btn-layout" data-mode="layout" data-tooltip="Layout Editor">
            <svg viewBox="0 0 24 24">
                <rect x="3" y="3" width="7" height="7"/>
                <rect x="14" y="3" width="7" height="7"/>
                <rect x="14" y="14" width="7" height="7"/>
                <rect x="3" y="14" width="7" height="7"/>
            </svg>
        </button>

        <!-- 3D Viewer Button -->
        <button class="icon-btn" id="btn-viewer" data-mode="viewer" data-tooltip="3D Viewer">
            <svg viewBox="0 0 24 24">
                <path d="M12 2L2 7l10 5 10-5-10-5z"/>
                <path d="M2 17l10 5 10-5"/>
                <path d="M2 12l10 5 10-5"/>
            </svg>
        </button>

        <div class="sidebar-spacer"></div>

        <!-- Settings Button (bottom) -->
        <button class="icon-btn" id="btn-settings" data-mode="settings" data-tooltip="Settings">
            <svg viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="3"/>
                <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
            </svg>
        </button>

        <div style="height: 60px;"></div> <!-- Space for status bar -->
    </aside>

    <!-- =============================================
         MAIN CONTENT AREA
         ============================================= -->
    <main class="main-content">
        <h1>ðŸ§ª Sidebar Standalone Test</h1>
        <p>Click sidebar buttons to test selection and hover effects.</p>
        
        <div class="current-mode">
            <div class="mode-label">Current Mode</div>
            <div class="mode-value" id="current-mode">Connection</div>
        </div>
    </main>

    <!-- =============================================
         STATUS BAR
         ============================================= -->
    <footer class="status-bar">
        <div class="status-group">
            <div class="status-item status-normal" id="status-server">
                <span class="dot"></span> Server: <span id="server-status">Disconnected</span>
            </div>
            <div class="status-item status-normal">
                User: Admin
            </div>
        </div>

        <div class="status-group">
            <div class="status-item status-warning" id="status-load" style="display: none;">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
                    <line x1="12" y1="9" x2="12" y2="13"/>
                    <line x1="12" y1="17" x2="12.01" y2="17"/>
                </svg>
                Load: <span id="load-value">0</span>%
            </div>
            
            <div class="status-item status-alarm" id="status-alarm" style="display: none;">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <line x1="15" y1="9" x2="9" y2="15"/>
                    <line x1="9" y1="9" x2="15" y2="15"/>
                </svg>
                <span id="alarm-message">No Alarms</span>
            </div>
        </div>
    </footer>

    <!-- =============================================
         TEST FRAMEWORK PANEL
         ============================================= -->
    <div class="test-framework" id="test-panel">
        <div class="test-header">
            <div class="test-title">ðŸ§ª Test Results</div>
            <div class="test-stats">
                <span class="stat-pass">âœ“ <span id="pass-count">0</span></span>
                <span class="stat-fail">âœ— <span id="fail-count">0</span></span>
                <span class="stat-pending">â—‹ <span id="pending-count">0</span></span>
            </div>
        </div>
        
        <div class="test-group">
            <div class="test-group-title">Visual Tests</div>
            <div class="test-item" id="test-sidebar-render">
                <span class="test-icon pending">â—‹</span>
                <span class="test-name">Sidebar renders correctly</span>
                <span class="test-time"></span>
            </div>
            <div class="test-item" id="test-buttons-visible">
                <span class="test-icon pending">â—‹</span>
                <span class="test-name">All buttons visible</span>
                <span class="test-time"></span>
            </div>
            <div class="test-item" id="test-status-bar">
                <span class="test-icon pending">â—‹</span>
                <span class="test-name">Status bar renders</span>
                <span class="test-time"></span>
            </div>
        </div>
        
        <div class="test-group">
            <div class="test-group-title">Interaction Tests</div>
            <div class="test-item" id="test-click-selection">
                <span class="test-icon pending">â—‹</span>
                <span class="test-name">Click selects button</span>
                <span class="test-time"></span>
            </div>
            <div class="test-item" id="test-hover-effect">
                <span class="test-icon pending">â—‹</span>
                <span class="test-name">Hover effect works</span>
                <span class="test-time"></span>
            </div>
            <div class="test-item" id="test-indicator-line">
                <span class="test-icon pending">â—‹</span>
                <span class="test-name">Selection indicator shows</span>
                <span class="test-time"></span>
            </div>
        </div>
        
        <div class="test-group">
            <div class="test-group-title">State Tests</div>
            <div class="test-item" id="test-mode-change">
                <span class="test-icon pending">â—‹</span>
                <span class="test-name">Mode changes on click</span>
                <span class="test-time"></span>
            </div>
            <div class="test-item" id="test-status-update">
                <span class="test-icon pending">â—‹</span>
                <span class="test-name">Status updates dynamically</span>
                <span class="test-time"></span>
            </div>
        </div>
        
        <div class="test-actions">
            <button class="test-btn test-btn-primary" onclick="runAllTests()">â–¶ Run All Tests</button>
            <button class="test-btn test-btn-secondary" onclick="resetTests()">â†º Reset</button>
        </div>
        
        <div class="test-log" id="test-log">
            <div class="log-entry info">Ready to run tests...</div>
        </div>
    </div>

    <!-- =============================================
         TEST SCRIPT
         ============================================= -->
    <script>
        // =============================================
        // Test Framework
        // =============================================
        const TestRunner = {
            results: { pass: 0, fail: 0, pending: 0 },
            
            log(message, type = 'info') {
                const logEl = document.getElementById('test-log');
                const entry = document.createElement('div');
                entry.className = `log-entry ${type}`;
                entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
                logEl.appendChild(entry);
                logEl.scrollTop = logEl.scrollHeight;
            },
            
            updateStats() {
                document.getElementById('pass-count').textContent = this.results.pass;
                document.getElementById('fail-count').textContent = this.results.fail;
                document.getElementById('pending-count').textContent = this.results.pending;
            },
            
            async runTest(testId, testFn) {
                const testEl = document.getElementById(testId);
                const iconEl = testEl.querySelector('.test-icon');
                const timeEl = testEl.querySelector('.test-time');
                
                iconEl.className = 'test-icon running';
                iconEl.textContent = 'âŸ³';
                
                const startTime = performance.now();
                
                try {
                    await testFn();
                    const duration = (performance.now() - startTime).toFixed(1);
                    iconEl.className = 'test-icon pass';
                    iconEl.textContent = 'âœ“';
                    timeEl.textContent = `${duration}ms`;
                    this.results.pass++;
                    this.results.pending--;
                    this.log(`âœ“ PASS: ${testEl.querySelector('.test-name').textContent}`, 'success');
                } catch (error) {
                    const duration = (performance.now() - startTime).toFixed(1);
                    iconEl.className = 'test-icon fail';
                    iconEl.textContent = 'âœ—';
                    timeEl.textContent = `${duration}ms`;
                    this.results.fail++;
                    this.results.pending--;
                    this.log(`âœ— FAIL: ${error.message}`, 'error');
                }
                
                this.updateStats();
            }
        };

        // =============================================
        // Sidebar Logic
        // =============================================
        const buttons = document.querySelectorAll('.icon-btn');
        let currentMode = 'connection';

        buttons.forEach(btn => {
            btn.addEventListener('click', function() {
                if (this.classList.contains('disabled')) return;
                
                buttons.forEach(b => b.classList.remove('selected'));
                this.classList.add('selected');
                
                const mode = this.dataset.mode;
                currentMode = mode;
                document.getElementById('current-mode').textContent = 
                    mode.charAt(0).toUpperCase() + mode.slice(1);
                
                TestRunner.log(`Mode changed to: ${mode}`, 'info');
            });
        });

        // =============================================
        // Test Definitions
        // =============================================
        const tests = {
            'test-sidebar-render': () => {
                const sidebar = document.getElementById('sidebar');
                if (!sidebar || sidebar.offsetWidth === 0) {
                    throw new Error('Sidebar not rendered');
                }
            },
            
            'test-buttons-visible': () => {
                const buttons = document.querySelectorAll('.icon-btn');
                if (buttons.length < 6) {
                    throw new Error(`Expected 6+ buttons, found ${buttons.length}`);
                }
                buttons.forEach(btn => {
                    if (btn.offsetWidth === 0) {
                        throw new Error('Button not visible');
                    }
                });
            },
            
            'test-status-bar': () => {
                const statusBar = document.querySelector('.status-bar');
                if (!statusBar || statusBar.offsetHeight === 0) {
                    throw new Error('Status bar not rendered');
                }
            },
            
            'test-click-selection': async () => {
                const btn = document.getElementById('btn-monitoring');
                btn.click();
                await new Promise(r => setTimeout(r, 100));
                
                if (!btn.classList.contains('selected')) {
                    throw new Error('Button not selected after click');
                }
            },
            
            'test-hover-effect': async () => {
                const btn = document.getElementById('btn-edit');
                const initialTransform = getComputedStyle(btn).transform;
                
                // Simulate hover (can't truly trigger :hover, but check CSS exists)
                const styles = getComputedStyle(btn);
                if (!styles.transition.includes('transform')) {
                    throw new Error('Hover transition not defined');
                }
            },
            
            'test-indicator-line': async () => {
                const btn = document.getElementById('btn-connection');
                btn.click();
                await new Promise(r => setTimeout(r, 100));
                
                const beforeStyle = getComputedStyle(btn, '::before');
                if (beforeStyle.content === 'none') {
                    throw new Error('Indicator line not showing');
                }
            },
            
            'test-mode-change': async () => {
                const btn = document.getElementById('btn-layout');
                btn.click();
                await new Promise(r => setTimeout(r, 100));
                
                const modeDisplay = document.getElementById('current-mode').textContent;
                if (modeDisplay.toLowerCase() !== 'layout') {
                    throw new Error(`Mode not updated: ${modeDisplay}`);
                }
            },
            
            'test-status-update': async () => {
                const serverStatus = document.getElementById('server-status');
                serverStatus.textContent = 'Connected (test-server)';
                
                const statusItem = document.getElementById('status-server');
                statusItem.classList.remove('status-normal');
                statusItem.classList.add('status-normal');
                
                await new Promise(r => setTimeout(r, 100));
                
                if (!serverStatus.textContent.includes('Connected')) {
                    throw new Error('Status not updated');
                }
            }
        };

        // =============================================
        // Test Runner Functions
        // =============================================
        async function runAllTests() {
            TestRunner.log('Starting all tests...', 'info');
            TestRunner.results = { pass: 0, fail: 0, pending: Object.keys(tests).length };
            TestRunner.updateStats();
            
            for (const [testId, testFn] of Object.entries(tests)) {
                await TestRunner.runTest(testId, testFn);
                await new Promise(r => setTimeout(r, 200));
            }
            
            TestRunner.log(`Tests completed: ${TestRunner.results.pass} passed, ${TestRunner.results.fail} failed`, 
                TestRunner.results.fail === 0 ? 'success' : 'error');
        }

        function resetTests() {
            TestRunner.results = { pass: 0, fail: 0, pending: Object.keys(tests).length };
            TestRunner.updateStats();
            
            document.querySelectorAll('.test-icon').forEach(el => {
                el.className = 'test-icon pending';
                el.textContent = 'â—‹';
            });
            
            document.querySelectorAll('.test-time').forEach(el => {
                el.textContent = '';
            });
            
            document.getElementById('test-log').innerHTML = 
                '<div class="log-entry info">Tests reset. Ready to run...</div>';
            
            // Reset sidebar state
            buttons.forEach(b => b.classList.remove('selected'));
            document.getElementById('btn-connection').classList.add('selected');
            document.getElementById('current-mode').textContent = 'Connection';
        }

        // =============================================
        // Simulation Functions (for testing)
        // =============================================
        function simulateConnection(connected = true) {
            const serverStatus = document.getElementById('server-status');
            const statusItem = document.getElementById('status-server');
            
            if (connected) {
                serverStatus.textContent = 'Connected (kr-b-01)';
                statusItem.classList.remove('status-alarm');
                statusItem.classList.add('status-normal');
            } else {
                serverStatus.textContent = 'Disconnected';
                statusItem.classList.remove('status-normal');
                statusItem.classList.add('status-alarm');
            }
        }

        function simulateWarning(show = true, value = 82) {
            const loadStatus = document.getElementById('status-load');
            const loadValue = document.getElementById('load-value');
            
            loadStatus.style.display = show ? 'flex' : 'none';
            loadValue.textContent = value;
        }

        function simulateAlarm(show = true, message = 'Sensor Err: #204') {
            const alarmStatus = document.getElementById('status-alarm');
            const alarmMessage = document.getElementById('alarm-message');
            
            alarmStatus.style.display = show ? 'flex' : 'none';
            alarmMessage.textContent = message;
        }

        // Initialize
        TestRunner.results.pending = Object.keys(tests).length;
        TestRunner.updateStats();
        
        // Expose to console
        window.simulateConnection = simulateConnection;
        window.simulateWarning = simulateWarning;
        window.simulateAlarm = simulateAlarm;
        
        console.log('ðŸ§ª Sidebar Standalone Test Loaded');
        console.log('Commands: simulateConnection(bool), simulateWarning(bool, value), simulateAlarm(bool, message)');
    </script>

</body>
</html>
