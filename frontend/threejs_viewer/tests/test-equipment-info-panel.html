<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ§ª Equipment Info Panel Test (v3.6.0 - Modular)</title>
    
    <!-- CSS ë¡œë“œ -->
    <link rel="stylesheet" href="../styles/base/_variables.css">
    <link rel="stylesheet" href="../styles/base/_reset.css">
    <link rel="stylesheet" href="../styles/components/_panels.css">
    <link rel="stylesheet" href="../styles/components/_equipment-info-panel.css">
    
    <style>
        /* í…ŒìŠ¤íŠ¸ í˜ì´ì§€ ì „ìš© ìŠ¤íƒ€ì¼ */
        body {
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            font-family: var(--font-family, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif);
            color: #fff;
        }
        
        .test-page {
            display: flex;
            gap: 20px;
            max-width: 1600px;
            margin: 0 auto;
        }
        
        /* ì™¼ìª½: í…ŒìŠ¤íŠ¸ ì»¨íŠ¸ë¡¤ */
        .test-controls {
            flex: 0 0 420px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
            height: fit-content;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .test-controls h1 {
            color: #4da6ff;
            font-size: 18px;
            margin: 0 0 8px 0;
        }
        
        .version-badge {
            display: inline-block;
            background: #22c55e;
            color: #000;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            margin-bottom: 15px;
        }
        
        .test-section {
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .test-section:last-child {
            border-bottom: none;
        }
        
        .test-section h2 {
            color: #9ca3af;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin: 0 0 8px 0;
        }
        
        .btn-group {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }
        
        .test-btn {
            padding: 6px 12px;
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 11px;
            font-weight: 500;
            transition: all 0.2s;
        }
        
        .test-btn:hover {
            background: #2563eb;
            transform: translateY(-1px);
        }
        
        .test-btn.run { background: #22c55e; }
        .test-btn.run:hover { background: #16a34a; }
        .test-btn.idle { background: #eab308; color: #000; }
        .test-btn.idle:hover { background: #ca8a04; }
        .test-btn.stop { background: #ef4444; }
        .test-btn.stop:hover { background: #dc2626; }
        .test-btn.sudden { background: #f97316; }
        .test-btn.sudden:hover { background: #ea580c; }
        .test-btn.secondary { background: #4b5563; }
        .test-btn.secondary:hover { background: #374151; }
        .test-btn.primary { background: #6366f1; }
        .test-btn.primary:hover { background: #4f46e5; }
        .test-btn.module { background: #8b5cf6; }
        .test-btn.module:hover { background: #7c3aed; }
        
        /* ì˜¤ë¥¸ìª½: íŒ¨ë„ ì˜ì—­ */
        .panel-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 20px;
            min-height: 600px;
        }
        
        .panel-container {
            display: flex;
            justify-content: center;
            align-items: flex-start;
        }
        
        /* Equipment Info Panel ìœ„ì¹˜ ì˜¤ë²„ë¼ì´ë“œ (í…ŒìŠ¤íŠ¸ìš©) */
        #equipmentInfo {
            position: relative !important;
            top: auto !important;
            right: auto !important;
            transform: none !important;
        }
        
        /* ëª¨ë“ˆ í…ŒìŠ¤íŠ¸ ì˜ì—­ */
        .module-test-area {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 15px;
        }
        
        .module-test-area h3 {
            color: #8b5cf6;
            font-size: 14px;
            margin: 0 0 12px 0;
            padding-bottom: 8px;
            border-bottom: 1px solid rgba(139, 92, 246, 0.3);
        }
        
        .module-output {
            background: #0a0a0a;
            border-radius: 8px;
            padding: 12px;
            min-height: 100px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 12px;
            color: #e5e5e5;
        }
        
        /* ë¡œê·¸ ì»¨í…Œì´ë„ˆ */
        .log-container {
            background: #000;
            border-radius: 8px;
            padding: 10px;
            height: 120px;
            overflow-y: auto;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 10px;
            margin-top: 12px;
        }
        
        .log-entry {
            margin: 2px 0;
            padding: 2px 5px;
            border-radius: 3px;
        }
        
        .log-entry.info { background: rgba(59, 130, 246, 0.2); color: #93c5fd; }
        .log-entry.success { background: rgba(34, 197, 94, 0.2); color: #86efac; }
        .log-entry.warning { background: rgba(234, 179, 8, 0.2); color: #fde047; }
        .log-entry.error { background: rgba(239, 68, 68, 0.2); color: #fca5a5; }
        .log-entry.module { background: rgba(139, 92, 246, 0.2); color: #c4b5fd; }
        
        /* ìƒíƒœ í‘œì‹œ */
        .status-bar {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 8px 12px;
            background: rgba(255,255,255,0.05);
            border-radius: 6px;
            font-size: 11px;
            margin-top: 12px;
        }
        
        .status-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #22c55e;
        }
        
        .status-dot.inactive { background: #ef4444; }
        .status-dot.loading { background: #eab308; animation: pulse 1s infinite; }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
    </style>
</head>
<body>
    <div class="test-page">
        <!-- ì™¼ìª½: í…ŒìŠ¤íŠ¸ ì»¨íŠ¸ë¡¤ -->
        <div class="test-controls">
            <h1>ğŸ§ª Equipment Info Panel Test</h1>
            <span class="version-badge">v3.6.0 Modular</span>
            
            <!-- ëª¨ë“ˆ Import í…ŒìŠ¤íŠ¸ -->
            <div class="test-section">
                <h2>ğŸ“¦ ëª¨ë“ˆ Import í…ŒìŠ¤íŠ¸</h2>
                <div class="btn-group">
                    <button class="test-btn module" onclick="testModuleImports()">ëª¨ë“ˆ ë¡œë“œ í™•ì¸</button>
                    <button class="test-btn module" onclick="testGaugeRenderer()">GaugeRenderer</button>
                    <button class="test-btn module" onclick="testDataFormatter()">DataFormatter</button>
                    <button class="test-btn module" onclick="testDurationTimer()">DurationTimer</button>
                </div>
            </div>
            
            <!-- Single Selection: ìƒíƒœë³„ -->
            <div class="test-section">
                <h2>ğŸ“Œ Single Selection - Status</h2>
                <div class="btn-group">
                    <button class="test-btn run" onclick="showSingle('RUN')">RUN</button>
                    <button class="test-btn idle" onclick="showSingle('IDLE')">IDLE</button>
                    <button class="test-btn stop" onclick="showSingle('STOP')">STOP</button>
                    <button class="test-btn sudden" onclick="showSingle('SUDDENSTOP')">SUDDEN</button>
                    <button class="test-btn secondary" onclick="showSingle('DISCONNECTED')">DISC</button>
                </div>
            </div>
            
            <!-- Lot Active / Inactive -->
            <div class="test-section">
                <h2>ğŸ“Œ Lot Active vs Inactive</h2>
                <div class="btn-group">
                    <button class="test-btn run" onclick="showLotActive()">âœ… Lot Active</button>
                    <button class="test-btn secondary" onclick="showLotInactive()">âŒ Lot Inactive</button>
                    <button class="test-btn secondary" onclick="showLotInactiveNoSince()">âŒ No Since</button>
                </div>
            </div>
            
            <!-- Multi Selection -->
            <div class="test-section">
                <h2>ğŸ“Œ Multi Selection</h2>
                <div class="btn-group">
                    <button class="test-btn primary" onclick="showMulti(3)">3ê°œ ì„ íƒ</button>
                    <button class="test-btn primary" onclick="showMulti(5)">5ê°œ ì„ íƒ</button>
                    <button class="test-btn primary" onclick="showMulti(10)">10ê°œ ì„ íƒ</button>
                </div>
            </div>
            
            <!-- PC Info Tab -->
            <div class="test-section">
                <h2>ğŸ“Œ PC Info Tab</h2>
                <div class="btn-group">
                    <button class="test-btn primary" onclick="showPCInfo('normal')">ì •ìƒ (30%)</button>
                    <button class="test-btn idle" onclick="showPCInfo('warning')">ê²½ê³  (70%)</button>
                    <button class="test-btn sudden" onclick="showPCInfo('critical')">ìœ„í—˜ (95%)</button>
                </div>
            </div>
            
            <!-- Disk D í…ŒìŠ¤íŠ¸ -->
            <div class="test-section">
                <h2>ğŸ“Œ Disk D ìœ ë¬´</h2>
                <div class="btn-group">
                    <button class="test-btn primary" onclick="showDiskD(true)">D: ìˆìŒ</button>
                    <button class="test-btn secondary" onclick="showDiskD(false)">D: ì—†ìŒ (N/A)</button>
                </div>
            </div>
            
            <!-- Unmapped / Error ìƒíƒœ -->
            <div class="test-section">
                <h2>ğŸ“Œ íŠ¹ìˆ˜ ìƒíƒœ</h2>
                <div class="btn-group">
                    <button class="test-btn secondary" onclick="showUnmapped()">Unmapped</button>
                    <button class="test-btn stop" onclick="showError()">Error</button>
                    <button class="test-btn secondary" onclick="showLoading()">Loading</button>
                </div>
            </div>
            
            <!-- Tab ì „í™˜ & íŒ¨ë„ ì œì–´ -->
            <div class="test-section">
                <h2>ğŸ› ï¸ Tab & íŒ¨ë„ ì œì–´</h2>
                <div class="btn-group">
                    <button class="test-btn secondary" onclick="switchTab('general')">General Tab</button>
                    <button class="test-btn secondary" onclick="switchTab('pcinfo')">PC Info Tab</button>
                    <button class="test-btn secondary" onclick="hidePanel()">ë‹«ê¸°</button>
                    <button class="test-btn secondary" onclick="clearLogs()">ë¡œê·¸ ì§€ìš°ê¸°</button>
                </div>
            </div>
            
            <!-- ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ ì‹œë®¬ë ˆì´ì…˜ -->
            <div class="test-section">
                <h2>âš¡ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸</h2>
                <div class="btn-group">
                    <button class="test-btn run" onclick="simulateRealtime()">â–¶ ì‹œì‘ (3ì´ˆ)</button>
                    <button class="test-btn stop" onclick="stopRealtime()">â–  ì¤‘ì§€</button>
                </div>
            </div>
            
            <!-- ìƒíƒœ í‘œì‹œ -->
            <div class="status-bar">
                <div class="status-item">
                    <span class="status-dot" id="panelStatusDot"></span>
                    <span id="panelStatusText">Panel: ë¹„í™œì„±</span>
                </div>
                <div class="status-item">
                    <span class="status-dot" id="moduleStatusDot"></span>
                    <span id="moduleStatusText">Modules: ë¡œë”© ì¤‘...</span>
                </div>
            </div>
            
            <!-- ë¡œê·¸ -->
            <div class="log-container" id="logContainer">
                <div class="log-entry info">[ì‹œì‘] í…ŒìŠ¤íŠ¸ í˜ì´ì§€ ë¡œë“œ ì¤‘...</div>
            </div>
        </div>
        
        <!-- ì˜¤ë¥¸ìª½: íŒ¨ë„ ì˜ì—­ -->
        <div class="panel-area">
            <!-- Equipment Info Panel -->
            <div class="panel-container">
                <div id="equipmentInfo">
                    <!-- EquipmentInfoPanelì´ ë™ì ìœ¼ë¡œ ìƒì„± -->
                </div>
            </div>
            
            <!-- ëª¨ë“ˆ í…ŒìŠ¤íŠ¸ ì¶œë ¥ ì˜ì—­ -->
            <div class="module-test-area">
                <h3>ğŸ”§ ëª¨ë“ˆ í…ŒìŠ¤íŠ¸ ì¶œë ¥</h3>
                <div class="module-output" id="moduleOutput">
                    ëª¨ë“ˆ í…ŒìŠ¤íŠ¸ ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.
                </div>
            </div>
        </div>
    </div>
    
    <script type="module">
        // =============================================
        // ğŸ†• v3.6.0: ES ëª¨ë“ˆ Import
        // =============================================
        import { EquipmentInfoPanel } from '../src/ui/EquipmentInfoPanel.js';
        import { GeneralTab } from '../src/ui/equipment-info/tabs/GeneralTab.js';
        import { PCInfoTab } from '../src/ui/equipment-info/tabs/PCInfoTab.js';
        import { GaugeRenderer } from '../src/ui/equipment-info/components/GaugeRenderer.js';
        import { HeaderStatus, STATUS_CONFIG } from '../src/ui/equipment-info/components/HeaderStatus.js';
        import { DurationTimer } from '../src/ui/equipment-info/utils/DurationTimer.js';
        import { DataFormatter } from '../src/ui/equipment-info/utils/DataFormatter.js';
        import { DataCache } from '../src/ui/equipment-info/utils/DataCache.js';
        import { mergeEquipmentData } from '../src/ui/equipment-info/utils/DataMerger.js';
        
        // =============================================
        // ì „ì—­ ìƒíƒœ
        // =============================================
        let panel = null;
        let generalTab = null;
        let pcInfoTab = null;
        let headerStatus = null;
        let realtimeTimer = null;
        let modulesLoaded = false;
        
        // =============================================
        // ë¡œê·¸ í•¨ìˆ˜
        // =============================================
        window.log = function(message, type = 'info') {
            const container = document.getElementById('logContainer');
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            const time = new Date().toLocaleTimeString('ko-KR', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
            entry.textContent = `[${time}] ${message}`;
            container.appendChild(entry);
            container.scrollTop = container.scrollHeight;
        };
        
        window.clearLogs = function() {
            document.getElementById('logContainer').innerHTML = '';
            log('ë¡œê·¸ ì´ˆê¸°í™”ë¨', 'info');
        };
        
        function setModuleOutput(content) {
            document.getElementById('moduleOutput').innerHTML = content;
        }
        
        // =============================================
        // íŒ¨ë„ ì´ˆê¸°í™” (Mock EquipmentEditState)
        // =============================================
        const mockEquipmentEditState = {
            getMapping: (frontendId) => {
                // Mock: ëª¨ë“  frontendIdì— ëŒ€í•´ ë§¤í•‘ ë°˜í™˜
                if (frontendId.includes('UNMAPPED')) {
                    return null;
                }
                return {
                    equipmentId: Math.floor(Math.random() * 1000) + 1,
                    equipment_id: Math.floor(Math.random() * 1000) + 1
                };
            }
        };
        
        // =============================================
        // íŒ¨ë„ ì œì–´
        // =============================================
        window.showPanel = function() {
            document.getElementById('equipmentInfo').classList.add('active');
            document.getElementById('panelStatusDot').classList.remove('inactive');
            document.getElementById('panelStatusText').textContent = 'Panel: í™œì„±';
            log('íŒ¨ë„ ì—´ë¦¼', 'success');
        };
        
        window.hidePanel = function() {
            document.getElementById('equipmentInfo').classList.remove('active');
            document.getElementById('panelStatusDot').classList.add('inactive');
            document.getElementById('panelStatusText').textContent = 'Panel: ë¹„í™œì„±';
            if (generalTab) generalTab.stopTimer();
            log('íŒ¨ë„ ë‹«í˜', 'info');
        };
        
        // =============================================
        // Tab ì „í™˜
        // =============================================
        window.switchTab = function(tabName) {
            document.querySelectorAll('.equipment-tab').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.tab === tabName);
            });
            
            document.querySelectorAll('.equipment-tab-content').forEach(content => {
                const contentTab = content.id.replace('tab-', '');
                content.classList.toggle('active', contentTab === tabName);
            });
            
            log(`Tab ì „í™˜: ${tabName}`, 'info');
        };
        
        // =============================================
        // ëª¨ë“ˆ í…ŒìŠ¤íŠ¸ í•¨ìˆ˜ë“¤
        // =============================================
        window.testModuleImports = function() {
            const results = [];
            
            results.push(`âœ… EquipmentInfoPanel: ${typeof EquipmentInfoPanel === 'function' ? 'OK' : 'FAIL'}`);
            results.push(`âœ… GeneralTab: ${typeof GeneralTab === 'function' ? 'OK' : 'FAIL'}`);
            results.push(`âœ… PCInfoTab: ${typeof PCInfoTab === 'function' ? 'OK' : 'FAIL'}`);
            results.push(`âœ… GaugeRenderer: ${typeof GaugeRenderer === 'function' ? 'OK' : 'FAIL'}`);
            results.push(`âœ… HeaderStatus: ${typeof HeaderStatus === 'function' ? 'OK' : 'FAIL'}`);
            results.push(`âœ… DurationTimer: ${typeof DurationTimer === 'function' ? 'OK' : 'FAIL'}`);
            results.push(`âœ… DataFormatter: ${typeof DataFormatter === 'function' ? 'OK' : 'FAIL'}`);
            results.push(`âœ… DataCache: ${typeof DataCache === 'function' ? 'OK' : 'FAIL'}`);
            results.push(`âœ… mergeEquipmentData: ${typeof mergeEquipmentData === 'function' ? 'OK' : 'FAIL'}`);
            results.push(`âœ… STATUS_CONFIG: ${STATUS_CONFIG ? 'OK' : 'FAIL'}`);
            
            setModuleOutput(`<pre>${results.join('\n')}</pre>`);
            log('ëª¨ë“ˆ Import í…ŒìŠ¤íŠ¸ ì™„ë£Œ', 'module');
        };
        
        window.testGaugeRenderer = function() {
            const cpuGauge = GaugeRenderer.renderCPU(45.5);
            const memoryGauge = GaugeRenderer.renderMemory(18.5, 32);
            const diskGauge = GaugeRenderer.renderDisk('C:', 120, 256);
            const naGauge = GaugeRenderer.renderNA('D:');
            
            setModuleOutput(`
                <div style="background: #1a1a2e; padding: 15px; border-radius: 8px;">
                    <h4 style="color: #4da6ff; margin: 0 0 10px 0;">GaugeRenderer ì¶œë ¥:</h4>
                    ${cpuGauge}
                    ${memoryGauge}
                    ${diskGauge}
                    ${naGauge}
                </div>
            `);
            log('GaugeRenderer í…ŒìŠ¤íŠ¸ ì™„ë£Œ', 'module');
        };
        
        window.testDataFormatter = function() {
            const now = new Date();
            const past = new Date(now - 5 * 24 * 60 * 60 * 1000);
            
            const results = [
                `formatDateTime: ${DataFormatter.formatDateTime(now.toISOString())}`,
                `formatDate: ${DataFormatter.formatDate(now.toISOString())}`,
                `formatTime: ${DataFormatter.formatTime(now.toISOString())}`,
                `formatBootDuration: ${DataFormatter.formatBootDuration(past.toISOString())}`,
                `getBootDurationClass: ${DataFormatter.getBootDurationClass(past.toISOString())}`,
                `shortenCpuName: ${DataFormatter.shortenCpuName('Intel(R) Core(TM) i7-12700K CPU @ 3.60GHz')}`,
                `formatListWithMore: ${DataFormatter.formatListWithMore(['A', 'B', 'C', 'D', 'E'], true)}`
            ];
            
            setModuleOutput(`<pre style="color: #86efac;">${results.join('\n')}</pre>`);
            log('DataFormatter í…ŒìŠ¤íŠ¸ ì™„ë£Œ', 'module');
        };
        
        window.testDurationTimer = function() {
            const startTime = new Date(Date.now() - 2 * 60 * 60 * 1000); // 2ì‹œê°„ ì „
            const formatted = DurationTimer.format(startTime);
            
            const results = [
                `format (2ì‹œê°„ ì „): ${formatted}`,
                `format (null): ${DurationTimer.format(null)}`,
                `DurationTimer ì¸ìŠ¤í„´ìŠ¤: ${new DurationTimer() ? 'OK' : 'FAIL'}`
            ];
            
            setModuleOutput(`<pre style="color: #fde047;">${results.join('\n')}</pre>`);
            log('DurationTimer í…ŒìŠ¤íŠ¸ ì™„ë£Œ', 'module');
        };
        
        // =============================================
        // Single Selection í‘œì‹œ
        // =============================================
        window.showSingle = function(status) {
            showPanel();
            
            document.getElementById('equipName').textContent = 'CUT-075';
            headerStatus.show();
            headerStatus.update(status);
            
            const now = new Date();
            const lotStart = new Date(now - 2 * 60 * 60 * 1000);
            
            const data = {
                is_lot_active: true,
                line_name: 'LINE-A',
                product_model: 'MODEL-2024-A',
                lot_id: 'LOT-20250109-001',
                lot_start_time: lotStart.toISOString(),
                last_updated: now.toISOString(),
                cpu_usage_percent: 45.2,
                memory_total_gb: 32,
                memory_used_gb: 18.5,
                disk_c_total_gb: 256,
                disk_c_used_gb: 120,
                disk_d_total_gb: 512,
                disk_d_used_gb: 280,
                cpu_name: 'Intel Core i7-12700K @ 3.60GHz',
                cpu_logical_count: 20,
                gpu_name: 'NVIDIA GeForce RTX 3060',
                os_name: 'Windows 10 Pro',
                os_architecture: '64-bit',
                last_boot_time: new Date(now - 5 * 24 * 60 * 60 * 1000).toISOString(),
                pc_last_update_time: now.toISOString()
            };
            
            generalTab.render(data);
            pcInfoTab.render(data);
            
            log(`Single Selection: ${status}`, 'success');
        };
        
        // =============================================
        // Lot Active / Inactive
        // =============================================
        window.showLotActive = function() {
            showPanel();
            
            document.getElementById('equipName').textContent = 'CUT-075';
            headerStatus.show();
            headerStatus.update('RUN');
            
            const now = new Date();
            const lotStart = new Date(now - 3 * 60 * 60 * 1000);
            
            generalTab.render({
                is_lot_active: true,
                line_name: 'LINE-A',
                product_model: 'PRODUCT-X500',
                lot_id: 'LOT-20250109-002',
                lot_start_time: lotStart.toISOString(),
                last_updated: now.toISOString()
            });
            
            log('Lot Active ìƒíƒœ í‘œì‹œ', 'success');
        };
        
        window.showLotInactive = function() {
            showPanel();
            
            document.getElementById('equipName').textContent = 'CUT-076';
            headerStatus.show();
            headerStatus.update('IDLE');
            
            const now = new Date();
            const sinceTime = new Date(now - 45 * 60 * 1000);
            
            generalTab.render({
                is_lot_active: false,
                line_name: 'LINE-B',
                since_time: sinceTime.toISOString(),
                last_updated: now.toISOString()
            });
            
            log('Lot Inactive ìƒíƒœ í‘œì‹œ (with Since)', 'success');
        };
        
        window.showLotInactiveNoSince = function() {
            showPanel();
            
            document.getElementById('equipName').textContent = 'CUT-077';
            headerStatus.show();
            headerStatus.update('DISCONNECTED');
            
            generalTab.render({
                is_lot_active: false,
                line_name: 'LINE-C',
                since_time: null,
                last_updated: new Date().toISOString()
            });
            
            log('Lot Inactive ìƒíƒœ í‘œì‹œ (no Since)', 'success');
        };
        
        // =============================================
        // PC Info Tab
        // =============================================
        window.showPCInfo = function(level) {
            showPanel();
            switchTab('pcinfo');
            
            document.getElementById('equipName').textContent = 'CUT-075';
            headerStatus.show();
            headerStatus.update('RUN');
            
            const now = new Date();
            let cpu, memory, diskC, diskD;
            
            switch (level) {
                case 'normal':
                    cpu = 28.5; memory = 10; diskC = 80; diskD = 150;
                    break;
                case 'warning':
                    cpu = 72.3; memory = 22; diskC = 180; diskD = 380;
                    break;
                case 'critical':
                    cpu = 95.8; memory = 30; diskC = 240; diskD = 490;
                    break;
            }
            
            pcInfoTab.render({
                cpu_usage_percent: cpu,
                memory_total_gb: 32,
                memory_used_gb: memory,
                disk_c_total_gb: 256,
                disk_c_used_gb: diskC,
                disk_d_total_gb: 512,
                disk_d_used_gb: diskD,
                cpu_name: 'Intel Core i7-12700K @ 3.60GHz',
                cpu_logical_count: 20,
                gpu_name: 'NVIDIA GeForce RTX 3060',
                os_name: 'Windows 10 Pro',
                os_architecture: '64-bit',
                last_boot_time: new Date(now - 5 * 24 * 60 * 60 * 1000).toISOString(),
                pc_last_update_time: now.toISOString()
            });
            
            log(`PC Info: ${level} ë ˆë²¨ í‘œì‹œ`, 'success');
        };
        
        // =============================================
        // Disk D í…ŒìŠ¤íŠ¸
        // =============================================
        window.showDiskD = function(hasDiskD) {
            showPanel();
            switchTab('pcinfo');
            
            document.getElementById('equipName').textContent = 'CUT-075';
            headerStatus.show();
            headerStatus.update('RUN');
            
            const now = new Date();
            
            pcInfoTab.render({
                cpu_usage_percent: 45.2,
                memory_total_gb: 32,
                memory_used_gb: 18.5,
                disk_c_total_gb: 256,
                disk_c_used_gb: 120,
                disk_d_total_gb: hasDiskD ? 512 : null,
                disk_d_used_gb: hasDiskD ? 280 : null,
                cpu_name: 'Intel Core i7-12700K @ 3.60GHz',
                cpu_logical_count: 20,
                gpu_name: 'NVIDIA GeForce RTX 3060',
                os_name: 'Windows 10 Pro',
                os_architecture: '64-bit',
                last_boot_time: new Date(now - 5 * 24 * 60 * 60 * 1000).toISOString(),
                pc_last_update_time: now.toISOString()
            });
            
            log(`Disk D: ${hasDiskD ? 'ìˆìŒ' : 'ì—†ìŒ (N/A)'}`, 'success');
        };
        
        // =============================================
        // Multi Selection
        // =============================================
        window.showMulti = function(count) {
            showPanel();
            switchTab('general');
            
            document.getElementById('equipName').textContent = `${count}ê°œ ì„¤ë¹„ ì„ íƒë¨`;
            document.getElementById('equipName').classList.add('multi-select');
            headerStatus.hide();
            generalTab.stopTimer();
            
            const statusCounts = {
                'RUN': Math.floor(count * 0.5),
                'IDLE': Math.floor(count * 0.3),
                'STOP': count - Math.floor(count * 0.5) - Math.floor(count * 0.3)
            };
            
            generalTab.renderMulti({
                count: count,
                lines: ['LINE-A', 'LINE-B', 'LINE-C'],
                lines_more: count > 3,
                status_counts: statusCounts,
                products: ['MODEL-X100', 'MODEL-X200', 'MODEL-X300'],
                products_more: count > 3,
                lot_ids: ['LOT-001', 'LOT-002', 'LOT-003'],
                lot_ids_more: count > 3
            }, count, count);
            
            pcInfoTab.renderMulti({
                avg_cpu_usage_percent: 52.3,
                avg_memory_usage_percent: 65.4,
                avg_disk_c_usage_percent: 48.7,
                avg_disk_d_usage_percent: count > 5 ? 55.2 : null,
                cpu_names: ['Intel Core i7-12700K', 'Intel Core i5-10400'],
                cpu_names_more: count > 3,
                gpu_names: ['NVIDIA RTX 3060', 'NVIDIA GTX 1660'],
                gpu_names_more: count > 3,
                os_names: ['Windows 10 Pro', 'Windows 11 Pro'],
                os_names_more: false
            }, count);
            
            log(`Multi Selection: ${count}ê°œ`, 'success');
        };
        
        // =============================================
        // íŠ¹ìˆ˜ ìƒíƒœ
        // =============================================
        window.showUnmapped = function() {
            showPanel();
            
            document.getElementById('equipName').textContent = 'EQ-UNMAPPED-01';
            headerStatus.show();
            headerStatus.update('DISCONNECTED');
            
            generalTab.showUnmapped('EQ-UNMAPPED-01', { position: { row: 5, col: 10 } });
            pcInfoTab.showUnmapped();
            
            log('Unmapped ìƒíƒœ í‘œì‹œ', 'warning');
        };
        
        window.showError = function() {
            showPanel();
            
            document.getElementById('equipName').textContent = 'EQ-ERROR-01';
            headerStatus.show();
            headerStatus.update('DISCONNECTED');
            
            generalTab.showError('EQ-ERROR-01', 'API ì—°ê²° ì‹¤íŒ¨: ì„œë²„ ì‘ë‹µ ì—†ìŒ');
            pcInfoTab.showError();
            
            log('Error ìƒíƒœ í‘œì‹œ', 'error');
        };
        
        window.showLoading = function() {
            showPanel();
            
            document.getElementById('equipName').textContent = 'Loading...';
            
            generalTab.showLoading();
            pcInfoTab.showLoading();
            
            log('Loading ìƒíƒœ í‘œì‹œ', 'info');
        };
        
        // =============================================
        // ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ ì‹œë®¬ë ˆì´ì…˜
        // =============================================
        window.simulateRealtime = function() {
            stopRealtime();
            
            log('ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ ì‹œì‘ (3ì´ˆ ê°„ê²©)', 'warning');
            
            let tick = 0;
            const statuses = ['RUN', 'IDLE', 'STOP', 'RUN', 'RUN'];
            
            showSingle('RUN');
            
            realtimeTimer = setInterval(() => {
                tick++;
                const status = statuses[tick % statuses.length];
                const now = new Date();
                
                headerStatus.update(status);
                
                const cpu = 30 + Math.random() * 50;
                const memory = 15 + Math.random() * 10;
                
                pcInfoTab.render({
                    cpu_usage_percent: cpu,
                    memory_total_gb: 32,
                    memory_used_gb: memory,
                    disk_c_total_gb: 256,
                    disk_c_used_gb: 120,
                    disk_d_total_gb: 512,
                    disk_d_used_gb: 280,
                    cpu_name: 'Intel Core i7-12700K @ 3.60GHz',
                    cpu_logical_count: 20,
                    gpu_name: 'NVIDIA GeForce RTX 3060',
                    os_name: 'Windows 10 Pro',
                    os_architecture: '64-bit',
                    last_boot_time: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000).toISOString(),
                    pc_last_update_time: now.toISOString()
                });
                
                log(`ì‹¤ì‹œê°„: Status=${status}, CPU=${cpu.toFixed(1)}%`, 'info');
            }, 3000);
        };
        
        window.stopRealtime = function() {
            if (realtimeTimer) {
                clearInterval(realtimeTimer);
                realtimeTimer = null;
                log('ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ ì¤‘ì§€', 'warning');
            }
        };
        
        // =============================================
        // ì´ˆê¸°í™”
        // =============================================
        function initPanel() {
            // íŒ¨ë„ HTML êµ¬ì¡° ìƒì„±
            const panelEl = document.getElementById('equipmentInfo');
            panelEl.innerHTML = `
                <button class="close-btn" onclick="hidePanel()">Ã—</button>
                
                <div class="equipment-panel-header">
                    <h2 id="equipName" class="equipment-panel-title">ì„¤ë¹„ ì •ë³´</h2>
                    <div class="header-status" id="headerStatus">
                        <span class="status-indicator" id="headerStatusIndicator"></span>
                        <span class="status-text" id="headerStatusText">-</span>
                    </div>
                </div>
                
                <div class="equipment-panel-tabs">
                    <button class="equipment-tab active" data-tab="general" onclick="switchTab('general')">General</button>
                    <button class="equipment-tab" data-tab="pcinfo" onclick="switchTab('pcinfo')">PC Info.</button>
                </div>
                
                <div class="equipment-panel-content">
                    <div id="tab-general" class="equipment-tab-content active">
                        <div id="generalTabContent">
                            <div class="info-row placeholder">
                                <span class="info-label">ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ í…ŒìŠ¤íŠ¸</span>
                            </div>
                        </div>
                    </div>
                    
                    <div id="tab-pcinfo" class="equipment-tab-content">
                        <div id="pcinfoTabContent">
                            <div class="info-row placeholder">
                                <span class="info-label">PC Infoë¥¼ ì„ íƒí•˜ì„¸ìš”</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // ì»´í¬ë„ŒíŠ¸ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
            headerStatus = new HeaderStatus(panelEl);
            generalTab = new GeneralTab(document.getElementById('generalTabContent'));
            pcInfoTab = new PCInfoTab(document.getElementById('pcinfoTabContent'));
            
            modulesLoaded = true;
            
            // ìƒíƒœ ì—…ë°ì´íŠ¸
            document.getElementById('moduleStatusDot').classList.remove('loading');
            document.getElementById('moduleStatusText').textContent = 'Modules: ë¡œë“œë¨ âœ…';
            
            log('ğŸ‰ v3.6.0 ëª¨ë“ˆ ì´ˆê¸°í™” ì™„ë£Œ!', 'success');
            log('ëª¨ë“ˆ í…ŒìŠ¤íŠ¸ ë˜ëŠ” íŒ¨ë„ í…ŒìŠ¤íŠ¸ë¥¼ ì‹œì‘í•˜ì„¸ìš”', 'info');
        }
        
        // DOM ë¡œë“œ í›„ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('moduleStatusDot').classList.add('loading');
            
            try {
                initPanel();
            } catch (error) {
                log(`âŒ ì´ˆê¸°í™” ì‹¤íŒ¨: ${error.message}`, 'error');
                document.getElementById('moduleStatusDot').classList.add('inactive');
                document.getElementById('moduleStatusText').textContent = 'Modules: ì˜¤ë¥˜ âŒ';
                console.error(error);
            }
        });
    </script>
</body>
</html>