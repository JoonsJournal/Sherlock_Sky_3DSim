/**
 * env-config.js
 * ==============
 * 런타임 환경 설정 파일 (UDS 설정 추가)
 * 
 * @version 2.1.0
 * @description
 * - 런타임 환경 변수 주입
 * - UDS Feature Flag 추가 (v2.1.0)
 * 
 * @changelog
 * - v2.1.0: UDS (Unified Data Store) 설정 추가 (2026-01-20)
 *   - UDS_ENABLED: Feature Flag
 *   - UDS_INITIAL_ENDPOINT: 초기 데이터 엔드포인트
 *   - UDS_STREAM_ENDPOINT: WebSocket 스트림 엔드포인트
 *   - UDS_POLL_INTERVAL: Delta 감지 주기
 * - v2.0.0: 중앙 집중식 포트 관리 도입
 * 
 * 📁 위치: frontend/threejs_viewer/public/env-config.js
 * 작성일: 2026-01-16
 * 수정일: 2026-01-20
 * 
 * ⚠️ 주의: 이 파일은 샘플입니다.
 *          기존 env-config.js에 UDS 관련 설정을 추가하세요.
 */

(function() {
    // =========================================================================
    // 포트 설정 (중앙 관리)
    // 서버 이전 시 이 값들만 수정하세요!
    // =========================================================================
    const BACKEND_PORT = 8008;
    const FRONTEND_PORT = 8088;
    
    // =========================================================================
    // 환경 변수 정의
    // =========================================================================
    window.ENV = {
        // 기본 포트 설정
        BACKEND_PORT: BACKEND_PORT,
        FRONTEND_PORT: FRONTEND_PORT,
        
        // API URL 설정
        API_BASE_URL: `http://${window.location.hostname}:${BACKEND_PORT}/api`,
        WS_URL: `ws://${window.location.hostname}:${BACKEND_PORT}/ws`,
        
        // 환경 설정
        DEBUG_MODE: true,
        ENVIRONMENT: 'development',
        
        // =========================================================
        // 🆕 v2.1.0: UDS (Unified Data Store) 설정
        // =========================================================
        
        /**
         * UDS Feature Flag
         * - true: UDS 방식 사용 (초기 로드 1회 → Delta Update)
         * - false: Legacy 방식 사용 (기존 API 호출)
         */
        UDS_ENABLED: true,
        
        /**
         * UDS 초기 데이터 엔드포인트
         * GET /api/uds/initial
         */
        UDS_INITIAL_ENDPOINT: '/api/uds/initial',
        
        /**
         * UDS WebSocket 스트림 엔드포인트
         * WS /api/uds/stream
         */
        UDS_STREAM_ENDPOINT: '/api/uds/stream',
        
        /**
         * UDS Delta 감지 주기 (ms)
         * Backend에서 이 주기로 변경 감지 후 WebSocket으로 전송
         */
        UDS_POLL_INTERVAL: 10000,  // 10초
        
        /**
         * UDS 초기 로드 타임아웃 (ms)
         * 이 시간 초과 시 Legacy 방식으로 폴백
         */
        UDS_INITIAL_TIMEOUT: 5000  // 5초
    };
    
    // 로드 확인 로그
    console.log('✅ [env-config] 런타임 환경 설정 로드됨 (v2.1.0)');
    console.log(`   └─ UDS_ENABLED: ${window.ENV.UDS_ENABLED}`);
    console.log(`   └─ API_BASE_URL: ${window.ENV.API_BASE_URL}`);
})();
