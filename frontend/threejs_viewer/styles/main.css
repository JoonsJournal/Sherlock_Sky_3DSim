/**
 * main.css
 * ========
 * SHERLOCK SKY 3DSim - CSS 진입점
 * 
 * @version 3.0.0 (Design Token 아키텍처)
 * @updated 2026-01-16 (Phase 1: Foundation 완료)
 * 
 * [ARCHITECTURE]
 * Layer 1: Design Tokens (primitives, semantic-light, semantic-dark, legacy-mapping)
 * Layer 2: Base Styles (reset, typography)
 * Layer 3: Components (22개 컴포넌트)
 * Layer 4: Pages (viewer-3d, layout-editor)
 * 
 * [CHANGELOG]
 * - v3.0.0: Design Token 아키텍처 전환
 *   - tokens/ 폴더 추가 (4개 파일)
 *   - Inter + JetBrains Mono 폰트 도입
 *   - 기존 변수 호환 레이어 유지
 * 
 * - v2.7.0: StatusBar CSS 충돌 해결
 * - v2.6.0: Analysis Mode CSS 추가
 * - v2.5.0: Overlay UI, Misc CSS 추가
 * - v2.4.0: ModeIndicatorPanel pill 스타일 지원
 * 
 * 위치: frontend/threejs_viewer/styles/main.css
 */

/* =============================================
   Layer 1: Design Tokens
   =============================================
   새로운 토큰 시스템 - _variables.css에서 import됨
   ============================================= */
@import './base/_variables.css';

/* =============================================
   Layer 2: Base Styles
   ============================================= */
@import './base/_reset.css';
@import './base/_typography.css';

/* =============================================
   Layer 3: Component Styles - Core
   ============================================= */
@import './components/_buttons.css';
@import './components/_modals.css';
@import './components/_panels.css';
@import './components/_forms.css';
@import './components/_toast.css';

/* =============================================
   Component Styles - Modal 시스템
   ============================================= */
@import './components/_equipment-edit-modal.css';
@import './components/_recovery-dialog.css';
@import './components/_connection-modal.css';

/* =============================================
   Component Styles - Indicator 시스템
   ============================================= */
@import './components/_connection-indicator.css'; 
@import './components/_autosave-indicator.css'; 

/* =============================================
   Component Styles - Panel 시스템
   ============================================= */
@import './components/_connection-panels.css';

/* =============================================
   Component Styles - 공통 UI
   ============================================= */
@import './components/_common-ui.css';
@import './components/_file-controls.css';
@import './components/_equipment-edit-button.css';

/* =============================================
   Component Styles - Equipment Info Panel
   ============================================= */
@import './components/_equipment-info-panel.css';

/* =============================================
   Cleanroom Sidebar Theme
   ============================================= */
@import './components/_sidebar.css';
@import './components/_status-bar.css';
@import './components/_cover-screen.css';

/* =============================================
   Mode Indicator Panel (Pill Style)
   CURRENT MODE (cyan) + DEV MODE (amber)
   ============================================= */
@import './components/_mode-indicator.css';

/* =============================================
   Analysis Mode
   Analysis 모드 컨테이너 및 Placeholder 스타일
   ============================================= */
@import './components/_analysis-mode.css';

/* =============================================
   Miscellaneous (Close Button, Legacy Styles)
   ============================================= */
@import './components/_misc.css';

/* =============================================
   Layer 4: Page Styles
   ============================================= */
@import './pages/_viewer-3d.css';
@import './pages/_layout-editor.css';

/* ============================================
   Monitoring Mode Status Panel
   선택자를 .status-panel 범위로 한정
   StatusBar의 .status-item, .status-label, .status-value와 충돌 방지
   ============================================ */

.status-panel {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-3) var(--spacing-6);
    display: flex;
    gap: var(--spacing-3);
    align-items: center;
    backdrop-filter: blur(var(--glass-blur));
    -webkit-backdrop-filter: blur(var(--glass-blur));
    z-index: var(--z-overlay-indicator);
    box-shadow: var(--glass-shadow);
    font-family: var(--font-family-base);
}

body:has(.status-bar) .status-panel {
    bottom: calc(var(--status-bar-height) + 20px);
}

/* .status-panel 범위로 한정 */
.status-panel .status-item {
    display: flex;
    align-items: center;
    gap: var(--spacing-1-5);
}

.status-panel .status-icon {
    font-size: var(--font-size-md);
}

.status-panel .status-icon.connected {
    color: var(--interactive-success);
}

.status-panel .status-icon.disconnected {
    color: var(--interactive-warning);
}

/* .status-panel 범위로 한정 */
.status-panel .status-label {
    color: var(--content-muted);
    font-size: var(--font-size-sm);
}

/* .status-panel 범위로 한정 */
.status-panel .status-value {
    color: var(--content-primary);
    font-weight: var(--font-weight-semibold);
    font-size: var(--font-size-base);
    font-family: var(--font-family-mono);
}

.status-panel .status-divider {
    color: var(--border-default);
    font-size: var(--font-size-base);
    margin: 0 var(--spacing-1);
}

.status-panel .status-progress-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--spacing-1);
}

.status-panel .status-progress {
    position: relative;
    width: 120px;
    height: 6px;
    background: var(--surface-secondary);
    border-radius: var(--radius-sm);
    overflow: hidden;
}

.status-panel .progress-bar {
    height: 100%;
    background: linear-gradient(90deg, var(--interactive-success), #8bc34a);
    border-radius: var(--radius-sm);
    transition: width var(--transition-slow);
}

.status-panel .progress-text {
    font-size: var(--font-size-xs);
    color: var(--content-muted);
    white-space: nowrap;
    font-family: var(--font-family-mono);
}

/* ============================================
   Equipment Labels (CSS2D)
   ============================================ */

.equipment-label {
    pointer-events: none;
    user-select: none;
    white-space: nowrap;
    font-family: var(--font-family-mono);
}

.equipment-label.unmapped {
    background: rgba(255, 87, 34, 0.9);
    color: white;
    padding: var(--spacing-1) var(--spacing-2);
    border-radius: var(--radius-sm);
    font-size: var(--font-size-xs);
    font-weight: var(--font-weight-bold);
    animation: pulse-warning 2s ease-in-out infinite;
}

@keyframes pulse-warning {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.8; transform: scale(1.05); }
}

/* ============================================
   Monitoring Mode Button Active State
   ============================================ */

#monitoringBtn.active {
    background: linear-gradient(135deg, #ff5722, #ff9800) !important;
    box-shadow: 0 0 20px rgba(255, 87, 34, 0.5);
    animation: monitoring-pulse 2s ease-in-out infinite;
}

@keyframes monitoring-pulse {
    0%, 100% { box-shadow: 0 0 10px rgba(255, 87, 34, 0.3); }
    50% { box-shadow: 0 0 25px rgba(255, 87, 34, 0.6); }
}

/* ============================================
   Legend Panel (Monitoring Mode)
   ============================================ */

.monitoring-legend {
    position: fixed;
    top: 100px;
    left: 20px;
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius-md);
    padding: var(--spacing-3);
    z-index: var(--z-dropdown);
    backdrop-filter: blur(var(--glass-blur));
    -webkit-backdrop-filter: blur(var(--glass-blur));
}

body:has(.sidebar) .monitoring-legend {
    left: calc(var(--sidebar-width) + 20px);
}

.legend-title {
    color: var(--content-primary);
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-bold);
    margin-bottom: var(--spacing-2);
    padding-bottom: var(--spacing-2);
    border-bottom: 1px solid var(--border-subtle);
}

.legend-item {
    display: flex;
    align-items: center;
    gap: var(--spacing-2);
    margin: var(--spacing-1-5) 0;
    font-size: var(--font-size-xs);
    color: var(--content-secondary);
}

.legend-color {
    width: 16px;
    height: 16px;
    border-radius: var(--radius-sm);
}

.legend-color.connected {
    background: var(--interactive-success);
    box-shadow: var(--glow-success, none);
}

.legend-color.disconnected {
    background: var(--content-muted);
    opacity: 0.5;
}

/* ============================================
   Theme Transition Support
   ============================================ */

html[data-theme] * {
    transition-property: background-color, border-color, color, box-shadow;
    transition-duration: var(--transition-base);
    transition-timing-function: ease;
}

/* 트랜지션 제외 요소 */
html[data-theme] canvas,
html[data-theme] video,
html[data-theme] iframe {
    transition: none;
}

html[data-theme] .toast,
html[data-theme] .toast *,
html[data-theme] .toast-container {
    transition: none;
}

/* Three.js 컨테이너 트랜지션 제외 */
html[data-theme] #threejs-container,
html[data-theme] #threejs-container * {
    transition: none;
}
